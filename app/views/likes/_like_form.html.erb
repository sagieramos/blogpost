<% if current_user.likes?(post) %>
  <%= form_with(model: current_user.likes.find_by(post_id: post.id), url: user_post_like_path(post.author, post, current_user.likes.find_by(post_id: post.id)), method: :delete) do |form| %>
    <%= form.submit 'Unlike', class: 'unlike-button' %>
  <% end %>
<% else %>
  <%= form_with(model: post.likes.build, url: user_post_likes_path(post.author, post), method: :post) do |form| %>
    <%= form.submit 'Like', class: 'like-button' %>
  <% end %>
<% end %>
